<!DOCTYPE html><html lang="zh-cn" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Win 平台下的 GCC 与 Clang | Jenway's Blog</title><meta name="author" content="Jenway"><meta name="copyright" content="Jenway"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="本文主要介绍如何在 Windows 平台下使用 GCC 与 Clang 编译器，以及 包括 Cygwin、MinGW、MinGW-w64、MSYS2 的历史 前置知识 如果你了解了下面这些知识，那么你可以跳过这一节。 点击 这里 跳过这一节。 什么是 GCC GCC (GNU Compiler Collection) 是 GNU 开发的编程语言编译器。它是 GNU 项目的关键部分，也是 GNU">
<meta property="og:type" content="article">
<meta property="og:title" content="Win 平台下的 GCC 与 Clang">
<meta property="og:url" content="https://blog.jenway.link/posts/8722d43e.html">
<meta property="og:site_name" content="Jenway&#39;s Blog">
<meta property="og:description" content="本文主要介绍如何在 Windows 平台下使用 GCC 与 Clang 编译器，以及 包括 Cygwin、MinGW、MinGW-w64、MSYS2 的历史 前置知识 如果你了解了下面这些知识，那么你可以跳过这一节。 点击 这里 跳过这一节。 什么是 GCC GCC (GNU Compiler Collection) 是 GNU 开发的编程语言编译器。它是 GNU 项目的关键部分，也是 GNU">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover38.webp">
<meta property="article:published_time" content="2023-05-22T18:13:24.000Z">
<meta property="article:modified_time" content="2024-12-25T16:44:32.383Z">
<meta property="article:author" content="Jenway">
<meta property="article:tag" content="gcc">
<meta property="article:tag" content="MinGW">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover38.webp"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://blog.jenway.link/posts/8722d43e.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')
          
          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Win 平台下的 GCC 与 Clang',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  isShuoshuo: false
}</script><!-- hexo injector head_end start --><link rel="stylesheet" href="/css/footerTransp.css?1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"/><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js/themes/blue/pace-theme-minimal.min.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background-image: url(img/bak.jpg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">54</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">11</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/bangumi/"><i class="fa-fw fas fa-bilibili"></i><span> Bangumi</span></a></li><li><a class="site-page child" href="/custom/homepage/index.html"><i class="fa-fw fas fa-graduation-cap"></i><span> CS50</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover38.webp);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Jenway's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Win 平台下的 GCC 与 Clang</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/bangumi/"><i class="fa-fw fas fa-bilibili"></i><span> Bangumi</span></a></li><li><a class="site-page child" href="/custom/homepage/index.html"><i class="fa-fw fas fa-graduation-cap"></i><span> CS50</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Win 平台下的 GCC 与 Clang</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2023-05-22T18:13:24.000Z" title="Created 2023-05-23 02:13:24">2023-05-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-12-25T16:44:32.383Z" title="Updated 2024-12-26 00:44:32">2024-12-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%86%B7%E7%9F%A5%E8%AF%86%E6%9D%82%E8%B0%88/">冷知识杂谈</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/posts/8722d43e.html#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><!-- <meting-js
    server="netease"
    type="song"
    autoplay="true"
    id="18126594">
</meting-js> -->
<p>本文主要介绍如何在 Windows 平台下使用 GCC 与 Clang 编译器，以及 包括 Cygwin、MinGW、MinGW-w64、MSYS2 的历史</p>
<h2 id="前置知识">前置知识</h2>
<p>如果你了解了下面这些知识，那么你可以跳过这一节。</p>
<p>点击 <a href="#win-%E4%B8%8B-gcc-%E7%9A%84%E4%B8%A4%E5%A4%A7%E6%80%9D%E8%B7%AF">这里</a> 跳过这一节。</p>
<h3 id="什么是-GCC">什么是 GCC</h3>
<p>GCC (GNU Compiler Collection) 是 GNU 开发的编程语言编译器。它是 GNU 项目的关键部分，也是 GNU 工具链的主要组成部分之一。GCC 目前支持的语言包括 C、C++、Objective-C、Fortran、Java、Ada、Go、D 以及各种处理器的汇编语言。</p>
<p>GCC 是自由软件，它的源代码在 GNU 通用公共许可证 (GPL) 下发布。GCC 由自由软件基金会 (FSF) 开发，是 GNU 项目的一部分。</p>
<h3 id="什么是-Clang">什么是 Clang</h3>
<p>Clang (C Language Family Frontend for LLVM) 是一个 C、C++、Objective-C 和 Objective-C++ 的编译器前端，它采用 LLVM 作为后端。Clang 是一个自由软件，它以 BSD 许可证授权发布。</p>
<blockquote>
<p>LLVM (Low Level Virtual Machine) 是一个编译器基础设施，它包含了一系列模块化的编译器组件和工具链，用于开发编译器前端和后端。LLVM 项目是一个开源项目，它被许多不同的公司和个人使用，包括 Apple、AMD、ARM、Sony、Intel、Google、NVIDIA、Adobe、Cray 等等。</p>
</blockquote>
<h2 id="Win-下使用-GCC-的两大思路">Win 下使用 GCC 的两大思路</h2>
<p>假如有以下的 C 程序</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello World!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个用户程序通过调用 C 标准库的 <code>printf</code> 函数来输出字符串，而 C 标准库的 <code>printf</code> 函数又通过调用操作系统提供的 API 来完成输出。</p>
<p>而显然，不同的操作系统提供的 API。</p>
<p>比如，Windows 提供的 Win API 中，可能会是这样的:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">BOOL WINAPI <span class="title function_">WriteConsole</span><span class="params">(</span></span><br><span class="line"><span class="params">  _In_             HANDLE  hConsoleOutput,</span></span><br><span class="line"><span class="params">  _In_       <span class="type">const</span> VOID    *lpBuffer,</span></span><br><span class="line"><span class="params">  _In_             DWORD   nNumberOfCharsToWrite,</span></span><br><span class="line"><span class="params">  _Out_opt_        LPDWORD lpNumberOfCharsWritten,</span></span><br><span class="line"><span class="params">  _Reserved_       LPVOID  lpReserved</span></span><br><span class="line"><span class="params">)</span>;</span><br></pre></td></tr></table></figure>
<p>而在 Linux 下，可能会是这样的 posix API:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">write</span><span class="params">(<span class="type">int</span> fd, <span class="type">const</span> <span class="type">void</span> *buf, <span class="type">size_t</span> count)</span>;</span><br></pre></td></tr></table></figure>
<p>这期间存在巨大的差异。导致 GCC 原生并不兼容 Windows，实际上，即使我们通过某种方法得到一个能在 Windows 下运行的 GCC，因为相应的 glibc 调用的仍然是 posix API，所以链接得到的程序仍然无法在 Windows 下运行。</p>
<p>就我的经验来说，有两种思路可以让 GCC 在 Windows 下编译出可执行文件：</p>
<blockquote>
<p>这两个系是我自己瞎编的，不要当真。</p>
</blockquote>
<ul>
<li>
<p><code>Cygwin</code> 系: 打包 Win API，提供一个类 posix API 的兼容层 (通常是一个动态链接库 .dll 文件)，glibc 仍然调用 posix API，但是这个 posix API (如 cygwin1.dll) 会调用 Win API。</p>
</li>
<li>
<p><code>MinGW</code> 系: 修改头文件、库文件、运行时，使得 glibc 调用的是 Win API。</p>
</li>
</ul>
<h2 id="在-Win-下使用-GCC-的历史">在 Win 下使用 GCC 的历史</h2>
<p>如果你对历史不感兴趣，那么你可以点击 <a href="%E4%B8%AD%E5%9C%BA%E6%80%BB%E7%BB%93GCC">这里</a> 跳过这一节。</p>
<h3 id="Cygwin">Cygwin</h3>
<blockquote>
<p>Cygwin 可能是最早的一种方法</p>
</blockquote>
<p>Cygwin 是一个在 Windows 上运行的流行 GNU 和其他开源工具的发行版。它的核心部分是 Cygwin 库，它提供了这些程序所需要的 POSIX 系统调用和环境。</p>
<blockquote>
<p>Cygwin 包含了来自开源世界的数千个软件包，包括大多数 GNU 工具、许多 BSD 工具、一个 X 服务器和一整套 X 应用程序。开发者可以找到大量允许你编写使用 POSIX API 的 Windows 控制台或 GUI 应用程序的工具、头文件和库。Cygwin 允许轻松地移植许多 Unix 程序，而无需对源代码进行大量更改。这包括配置和构建大多数可用的 GNU 或 BSD 软件，甚至包括 Cygwin 发行版本身包含的软件包。可以从提供的 Unix shell（如 bash、tcsh 或 zsh）中来使用它们。</p>
</blockquote>
<p>1995 年，Cygnus 工程师 Steve Chamberlain 观察到 Windows NT 和 95 使用 COFF 作为它们的目标文件格式，而 GNU 已经包含了对 x86 和 COFF 的支持，以及 C 库 newlib。他认为可以重新定位 GCC 并生成一个交叉编译器，可以在 Windows 上运行。这被证明是可行的，很快就开发出了一个原型。这便是 Cygwin 的起源。</p>
<p>这个项目现今的leader是 Corinna Vinschen，网站是 <a target="_blank" rel="noopener" href="https://cygwin.com/">https://cygwin.com/</a></p>
<h4 id="什么是-Cygwin">什么是 Cygwin?</h4>
<p>Cygwin 是:</p>
<ul>
<li>一个大型的 GNU 和开源工具集合，它提供了类似于 Linux 发行版的功能，可以在 Windows 上使用 GNU 和其他开源工具。（如 Bash、make、g++、git、vim 等等）</li>
<li>一个 DLL (cygwin1.dll)，它提供了大量的 POSIX API 功能。</li>
</ul>
<h4 id="什么不是-Cygwin">什么不是 Cygwin?</h4>
<p>Cygwin 不是:</p>
<ul>
<li>一种在 Windows 上运行原生 Linux 应用程序的方法。如果你想让它在 Windows 上运行，你必须从源代码重新构建你的应用程序。</li>
<li>一种让原生 Windows 应用程序自动感知 UNIX® 功能（如signal、pty 等）的方法。同样，如果你想利用 Cygwin 的功能，你需要从源代码构建你的应用程序。</li>
</ul>
<h3 id="MinGW">MinGW</h3>
<p>MinGW (“Minimalist GNU for Windows”), 是一个免费开源的软件开发环境，用于创建 Microsoft Windows 应用程序。</p>
<p>它出现的时间相当早,在 1998 年就已经诞生了雏形</p>
<blockquote>
<p>在 1998 年，Colin Peters 编写了最初的版本，那时它只包含了一个 Cygwin 版本的 GCC。 Jan-Jaap van der Heijden 创建了一个 Windows 本地版本的 GCC，并添加了 binutils 和 make。Mumit Khan 后来接管了开发工作。</p>
</blockquote>
<p>在 2000 年，该项目迁移到 SourceForge，并在 2005 年 9 月被选为 SourceForge 的月度项目。</p>
<p>在 2018 年，由于与 SourceForge 关于邮件列表管理的分歧，MinGW 迁移到了 OSDN。</p>
<p>相比 <a href="#cygwin">Cygwin</a>, 这个项目已经式微，原来的官网 <a target="_blank" rel="noopener" href="http://mingw.org">mingw.org</a> 已经无法访问，取而代之的是 OSDN 上的 <a target="_blank" rel="noopener" href="https://osdn.net/projects/mingw">https://osdn.net/projects/mingw</a></p>
<p>尽管还有缓慢的更新，但是它的各方面都已经落后了，如今基本也不会有人推荐</p>
<p>平常我们说的和遇到的 MinGW，一般指的是 MinGW-w64</p>
<h3 id="MinGW-w64">MinGW-w64</h3>
<p>在 2007 年，原来的 MinGW 的一个分支 MinGW-w64 出现了，以支持 64 位和新的 API。从那时起，它就被广泛的使用和分发。</p>
<p>MinGW-w64 是原来的 <a target="_blank" rel="noopener" href="http://mingw.org">mingw.org</a> 项目的一个分支。它在 2007 年 fork 了原来的项目，以支持 64 位和新的 API。从那时起，它就被广泛的使用和分发。</p>
<h4 id="一个小故事">一个小故事</h4>
<p>原来的 MinGW 开发进展缓慢，它的开发者甚至不考虑添加 64 位目标生成支持。一个雄心勃勃的家伙，Kai Tietz，于是 fork 了原来的项目，因为他的公司需要在 Windows 上构建 64 位目标。这就是 MinGW-w64 项目的诞生。</p>
<p>尽管最初的目标只是添加 64 位支持，但开发人员在许多方面改进了工具链，并解决了大量其他问题。从那时起，MinGW-w64 项目已经发展壮大，现在在质量方面远远领先于 MinGW。</p>
<p>当 MinGW-w64 提议 MinGW 加入他们的行列来共同合作时，MinGW 的开发人员给出了不好的反应，并拒绝了合作。结果，今天就有两个名字容易引起混淆的项目，但在质量和支持方面的差异是显而易见的。</p>
<h4 id="MinGW-w64-并不包含-gcc-编译器"><strong>MinGW-w64 并不包含 gcc 编译器</strong></h4>
<p>实际上，我们到现在也可以看到，我们说的 MinGW-w64，其实严格来说是不包含 gcc 编译器的，MinGW-w64 项目主要提供的是 修改过的 头文件、库文件、运行时等等。但是大多数的 personal build 都会包含 gcc 编译器，以及其它诸多工具，甚至还会包含 LLVM/Clang 等等。这也就意味着，这些 build 不一定要有 gcc，只有 LLVM/Clang 也是存在的</p>
<h4 id="MinGW-w64的众多Build">MinGW-w64的众多Build</h4>
<p>事实上，MinGW-w64 项目本身并不是一个软件发行版。它几乎只提供源码，基本所有的 MinGW-w64 的用户都是使用其他人编译好的 personal build。</p>
<ul>
<li>
<p>官网推荐的 personal build (win 平台下)有:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/niXman/mingw-builds-binaries">MinGW-builds</a> 由 <code>niXman</code> 等人维护, 提供 GCC with MinGW-W64 ，并且提供了一个在线图形化安装包</li>
<li><a target="_blank" rel="noopener" href="https://winlibs.com/">WinLibs (强烈推荐)</a>，由 <code>Brecht Sanders</code> 提供，同时有包括 GCC + LLVM + MinGW-w64 的版本，和不包括 LLVM/Clang 的版本，只提供压缩包 (维护者认为这样更 portable)</li>
<li><a target="_blank" rel="noopener" href="https://github.com/mstorsjo/llvm-mingw">LLVM-MinGW</a> 一个基于LLVM/Clang/LLD 的 mingw-w64 工具链，显然 <strong>不包含 gcc</strong></li>
</ul>
</li>
<li>
<p>其它的比较及时的 build 但是没在官网上列出来:</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.equation.com/servlet/equation.cmd?fa=fortran">Equation Solution</a> 提供一个自解压程序，可以用压缩软件打开来手动解压，或者是自动安装，值得一提的是，它提供一个快照版，提供相当新的 gcc 编译器(现在是 2023 年，gcc 14)，不过稳定性不做保证，而且其实 WinLibs 也提供了一个快照版</li>
</ul>
</li>
<li>
<p>其它平台的 MinGW-w64 build</p>
<p>是的，MinGW-w64 并不包含 gcc，而是一套头文件、库文件、运行时，这也就意味着你可以在其它平台上，如 Linux、Cygwin、docker、MSYS2 下来使用，交叉编译出可以在 windows 下原生运行 ( 不需要附加 dll ) 的程序</p>
<p>官网推荐了这些 <a target="_blank" rel="noopener" href="https://www.mingw-w64.org/downloads/">https://www.mingw-w64.org/downloads/</a></p>
</li>
<li>
<p>理论上更新最及时的 build</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.msys2.org/">MSYS2</a> 虽然严格来说 MSYS2 包含更多的东西，但是它提供了一个几乎是最新的 MinGW-w64 的 build</li>
</ul>
</li>
<li>
<p>更新缓慢的 build:</p>
<ul>
<li>
<p><a target="_blank" rel="noopener" href="https://sourceforge.net/projects/mingw-w64/files/">SourceForge 上的(官方?) build</a> 版本很老，GCC 的版本最新是 8.1，然而如今 2023 年，GCC 的版本已经到 13 了，很多教程似乎都指向这里，而且如果硬要有一个 <code>官方 build</code>,那也只能是这个了</p>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://jmeubank.github.io/tdm-gcc/">tdm-gcc</a> 由<code>John E. / TDM</code> 一人维护，Code::Blocks 内置的就是这款，其上一次更新是 2021 年，gcc 10.3 , 比较慢了，值得一提的是，TDM-GCC 相比其它的 build 有一个不同之处</p>
<blockquote>
<p>它和其它编译套装有些不同。最重要的是，它将默认的 GCC 运行时库更改为静态链接，并使用共享内存区域处理异常。</p>
</blockquote>
</li>
<li>
<p><a target="_blank" rel="noopener" href="https://nuwen.net/mingw.html">MinGW Distro - nuwen.net</a> 同样，上一次更新在 2021 年，包含了 GCC 11.2.0 和 Boost 等许多库</p>
</li>
</ul>
</li>
</ul>
<h3 id="MSYS2">MSYS2</h3>
<p>MSYS2 是 MinGW-w64 的姊妹项目。（是的，它们俩几乎是一家人）</p>
<blockquote>
<p>还记得前文说过， MinGW-w64 官方已经很久没有更新二进制源码分发了吗？据说就是因为社区现在的重心都在 MSYS2 上，而 MSYS2 中就会有最及时的 MinGW-w64 build</p>
</blockquote>
<p>MSYS2 是 MSYS 的独立重写，基于现代的 Cygwin 和 MinGW-w64，旨在与 native Windows 软件更好地互操作。</p>
<p>这个名字是 Minimal SYStem 2 的缩写，旨在提供支持，以便使用 bash shell、Autotools、版本控制系统等来使用 MinGW-w64 工具链构建本机 Windows 应用程序。并移植了 Pacman (来自 Arch Linux) 作为包管理系统来提供简单的软件包安装</p>
<h4 id="与-Cygwin的关系">与 Cygwin的关系</h4>
<p>Cygwin 是 Windows 上的 POSIX 平台（Win32 子系统），运行在用户模式下。它在运行时需要一个 POSIX 兼容层。它不是 Linux 的仿模拟器，也不是 WSL。</p>
<p>我们希望 MSYS2 被视为 Cygwin 的一个补充分支（甚至希望被 Cygwin 的开发人员接受！），我们仍然希望 MSYS2 有一天可以作为 Cygwin 的特殊模式运行（通过 DLL 插件机制）。</p>
<h4 id="与MinGW-w64">与MinGW-w64</h4>
<p>MinGW 是 Minimalist GNU for Windows 的缩写。MinGW 的想法是为 Windows 提供一个开发平台，用于构建跨平台应用程序。重要的部分是:</p>
<p>一个 FOSS Windows 特定的头文件和导入库，它们使得可以使用 Windows API，<br>
一个补充库和一个运行时，填补了一些空白。但这个术语通常包括跨平台的 GNU 开发工具:</p>
<ul>
<li>GNU Compiler Collection (GCC),</li>
<li>GNU Binutils (assembler, linker, archive manager),</li>
<li>GNU Debugger (GDB),</li>
<li>and miscellaneous utilities.</li>
</ul>
<p>至少有两个项目在实现这个想法:</p>
<ul>
<li>原始的 MinGW 项目，有时被称为 <a target="_blank" rel="noopener" href="http://mingw.org">mingw.org</a></li>
<li>MinGW-w64 项目，它本身并不是一个软件发行版。有多个 mingw-w64 工具链的构建版本，以及使用 MinGW-w64 构建的多个软件发行版。</li>
</ul>
<h3 id="MinGW-和-MinGW-w64-不是同一个项目"><strong>MinGW 和 MinGW-w64 不是同一个项目</strong></h3>
<p>MinGW 是一个软件发行版和开发平台。它附带了 MSYS，一个旧的 Cygwin 分支。MSYS2 和 MinGW-w64 项目与 MSYS 和 MinGW 无关，除了名称和共同目标之外。</p>
<p>MSYS2 是 MSYS 和 MinGW 的精神继承者。MSYS 虽然确实有用，但是它真的很老了，而且妨碍了开发人员。MSYS2 是为了取代原来的 MSYS 而创建的，同时避免了它的问题。</p>
<h2 id="中场总结-GCC">中场总结 GCC</h2>
<p>如果你的代码使用 posix api，想得到linux兼容性比较高的程序，那么就稍加修改，使用 msys-2.0.dll或者cygwin1.dll</p>
<p>如果你没有这些需求，那用 MinGW-w64 搭配一款编译器 (gcc 或者 clang)</p>
<p>最简单的方法就是找一个靠谱、及时的社区 build</p>
<p>推荐 <a target="_blank" rel="noopener" href="https://winlibs.com/">WinLibs (强烈推荐)</a>，提供一整套工具链 (GCC + LLVM + MinGW-w64 已经一些 GNU 套件)</p>
<p>或者你也可以在 MSYS2 中下载 MinGW-w64，更新最及时，毕竟它们一家人</p>
<blockquote>
<p>值得一提的是在 cygwin 或者 MSYS2中 gcc 一般会找到两个版本，不带 MinGW 后缀的就是通过调用 msys2 或者 cygwin 的 dll的，带 MinGW 后缀的自然就是后面又链接的 MinGW-w64的库，显然，少了一层模拟层，效率会高不少</p>
</blockquote>
<p>如果想在 Windows 上用 bash sed grep awk 等等一系列强大的工具，那么cygwin和msys2还是非常有必要装一个的。什么？你要用 WSL2？那好吧，不过 IO 效率恐怕会是个问题</p>
<h2 id="Win-下-Clang-的两种编译器后端">Win 下 Clang 的两种编译器后端</h2>
<p>Win 下的 Clang 有两种编译器后端：</p>
<ul>
<li>MSVC</li>
<li>GCC，严格来说是，一般是 MinGW-w64</li>
</ul>
<p>如果想使用前者的话，下载 Visual Studio Installer，在负载里面勾选上就好，然后在 VS 的项目设置里把编译前端改为 Clang，这里就不赘述了，网上的教程很全</p>
<p>如果是后者的话，我们当然可以从 LLVM 开始自己构建，不过最简单的还是去找 MinGW-w64 社区构建的懒人包，比如 LLVM-MinGW 或者 WinLibs，参见<a href="MinGW-w64%E7%9A%84%E4%BC%97%E5%A4%9ABuild">这里</a></p>
<p>如果你想自己构建，那么可以参考 <a target="_blank" rel="noopener" href="https://clang.llvm.org/get_started.html">这里</a></p>
<h2 id="posix、线程模型、ABI-以及其他">posix、线程模型、ABI 以及其他</h2>
<p>当你仔细观察 MinGW-w64 的 Build 的名字，你会发现许多名词</p>
<h3 id="x86-64-vs-i686">x86_64 vs i686</h3>
<p>前者是 64 位，后者是 32 位</p>
<h3 id="posix-vs-win32-vs-MCF">posix vs win32 vs MCF</h3>
<p>这里的指的是线程库<br>
Windows 上的 GCC 可以使用以下线程库构建:</p>
<ul>
<li>POSIX (最好的兼容性)</li>
<li>WIN32 (原生 Windows 线程，但是缺少 POSIX 线程 / pthread.h)<br>
MCF (since GCC 13, see also: MCF Gthread Library)</li>
<li>MCF (从 GCC 13 开始支持了,参见 <a target="_blank" rel="noopener" href="https://github.com/lhmouse/mcfgthread/">MCF Gthread Library</a> )</li>
</ul>
<h3 id="sjlj-vs-dwarf-vs-seh">sjlj vs dwarf vs seh</h3>
<p>这里的指的是异常处理</p>
<ul>
<li>sjlj (setjmp/longjmp) 32 位和 64 位都能用即使不抛出exception，也会造成较小的性能损失（在exception大的代码中约为15％） – 允许exception遍历例如窗口callback</li>
<li>dwarf (DW2，dwarf-2): 只有32位可用, 没有永久的运行时间开销, 需要整个调用堆栈被启用，这意味着exception不能被抛出，例如Windows系统DLL。</li>
<li>SEH: (zero overhead exception) 只可用于64位</li>
</ul>
<p>这张图片说的不错，来源为 <a target="_blank" rel="noopener" href="https://img2022.cnblogs.com/blog/871381/202208/871381-20220824185140178-1269533179.png">这里</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.statically.io/gh/Jenway/J-figure-Bed/main/post/2023/life/kita.jpg" alt="sjlj vs dwarf vs seh"></p>
<h3 id="MSVCRT-与-UCRT">MSVCRT 与 UCRT</h3>
<p>前者很老了，后者是新的而且更好，但是后者只有 Windows 10 及以上才有</p>
<p>在 Microsoft Windows 上有两种不同的 C 标准库</p>
<p><strong>MSVCRT</strong> (Microsoft Visual C++ Runtime) 在所有的 Windows 版本都是可用的，但是它因为历史原因已经很落后，不支持 C99 标准并且缺失了一些 特性</p>
<ul>
<li>它不支持 C99 标准，比如 printf() 家族，但是…</li>
<li>MinGW-w64 提供了一些替代函数，使得在许多情况下都可以兼容 C99</li>
<li>It doesn’t support the UTF-8 locale</li>
<li>它不支持 UTF-8 本地化</li>
<li>由于内部结构和数据类型不同，使用 MSVCRT 链接的二进制文件不应该与使用 UCRT 链接的二进制文件混合。 (更严格地说，不同目标的目标文件或静态库不应该混合。使用不同 CRT 构建的 DLL 可以混合，只要它们不跨 DLL 边界共享 CRT 对象，例如 FILE*。) 对于 MSVC 编译的二进制文件也适用相同的规则，因为 MSVC 默认使用 UCRT 。</li>
<li>在所有的 Windows 版本都是可用的</li>
</ul>
<p><strong>UCRT</strong> (Universal C Runtime) 是一个较新的版本，它也是 Microsoft Visual Studio 的默认版本</p>
<p>与 MSVC 的兼容性更好，无论是在构建时还是在运行时。它只在 Windows 10 及以上默认提供，对于旧版本，你必须自己提供它，或者确保用户已经安装了它。</p>
<h2 id="总结">总结</h2>
<ul>
<li>Cygwin 提供了一个类 posix API 的兼容层 (通常是一个动态链接库 .dll 文件)，glibc 仍然调用 posix API，但是这个 posix API (如 cygwin1.dll) 会调用 Win API。</li>
<li>MinGW 基本已经成为历史了，MSYS 也是</li>
<li>MinGW-w64 提供了一套头文件、库文件、运行时，使得 glibc 调用的是 Win API。</li>
<li>MinGW-w64 基本只发布源码，二进制的发布大多都是社区的 personal build</li>
<li>Brent Sanders 的 WinLibs 是一个很赞的 personal build，它提供了 GCC + LLVM + MinGW-w64 以及一些 GNU 套件</li>
<li>MinGW-w64 并不包含 gcc 编译器，但是大多数的 personal build 都会包含 gcc 编译器，以及其它诸多工具，甚至还会包含 LLVM/Clang 等等。</li>
<li>MSYS2 是 Cygwin 的独立重写，基于现代的 Cygwin 和 MinGW-w64，旨在与 native Windows 软件更好地互操作。</li>
<li>MSYS2 是 MinGW-w64 的姊妹项目，它提供了一个包管理器，可以方便的安装最新的 MinGW-w64</li>
<li>Windows 下 Clang 有两种编译器后端：MSVC 和 GCC (MinGW-w64)</li>
<li>Cygwin: Get that Linux feeling - on Windows</li>
<li>MinGW-w64: A Complete Runtime Environment for gcc &amp; LLVM for 32 and 64 bits Windows</li>
<li>MSYS2: Software Distribution and Building Platform for Windows</li>
</ul>
<h2 id="参考资料">参考资料</h2>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/MinGW">https://en.wikipedia.org/wiki/MinGW</a><br>
<a target="_blank" rel="noopener" href="https://mingw-w64.org/">https://mingw-w64.org/</a><br>
<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/19425482/windows-c-compiler-with-full-c11-support-should-work-with-qt">https://stackoverflow.com/questions/19425482/windows-c-compiler-with-full-c11-support-should-work-with-qt</a><br>
<a target="_blank" rel="noopener" href="https://jmeubank.github.io/tdm-gcc/">https://jmeubank.github.io/tdm-gcc/</a><br>
<a target="_blank" rel="noopener" href="https://github.com/niXman/mingw-builds-binaries">https://github.com/niXman/mingw-builds-binaries</a><br>
<a target="_blank" rel="noopener" href="https://github.com/mstorsjo/llvm-mingw">https://github.com/mstorsjo/llvm-mingw</a><br>
<a target="_blank" rel="noopener" href="https://winlibs.com/">https://winlibs.com/</a><br>
<a target="_blank" rel="noopener" href="https://nuwen.net/mingw.html">https://nuwen.net/mingw.html</a><br>
<a target="_blank" rel="noopener" href="http://www.equation.com/servlet/equation.cmd?fa=fortran">http://www.equation.com/servlet/equation.cmd?fa=fortran</a><br>
<a target="_blank" rel="noopener" href="https://www.cnblogs.com/feipeng8848/p/15227688.html">https://www.cnblogs.com/feipeng8848/p/15227688.html</a><br>
<a target="_blank" rel="noopener" href="https://www.msys2.org/docs/environments/#msvcrt-vs-ucrt">https://www.msys2.org/docs/environments/#msvcrt-vs-ucrt</a><br>
<a target="_blank" rel="noopener" href="https://www.msys2.org/docs/what-is-msys2/">https://www.msys2.org/docs/what-is-msys2/</a><br>
<a target="_blank" rel="noopener" href="https://www.msys2.org/wiki/History/">https://www.msys2.org/wiki/History/</a></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://github.com/Jenway">Jenway</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://blog.jenway.link/posts/8722d43e.html">https://blog.jenway.link/posts/8722d43e.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/gcc/">gcc</a><a class="post-meta__tags" href="/tags/MinGW/">MinGW</a></div><div class="post-share"><div class="social-share" data-image="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover38.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/posts/b8c13c86.html" title="那时年少春衫薄"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover12.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">那时年少春衫薄</div></div><div class="info-2"><div class="info-item-1"> ​            如今却忆江南乐，当时年少春衫薄。骑马倚斜桥，满楼红袖招。翠屏金屈曲，醉入花丛宿。此度见花枝，白头誓不归——韦庄《菩萨蛮·如今却忆江南乐》   刚才在知乎上看到一个孩子，提问了许多问题，大抵就是11岁学编程先学C 还是 Rust什么的，看样子，是觉得人工智能很火，现在要早早入局，以后卷起一片风云的人物。我也不得不想起，我刚上初中的时候也是这样，对编程很感兴趣，我那个时候是怎样的来着？让我想想。 在我的青春将至的少年时节，我有好多奢望。  虽然囿于小小的天井，不过幸运，或者说无关紧要的是，在我年少的时候我有着一台台式机，连通着互联网。 我因而看到了很多，这些繁杂而又瑰丽的信息让我不由得神往，这些信息勾起了少年的欲望。 那个时候，还是诸如德国下水道，日本夏令营的故事大有受众的时候，我当然也不例外，漫威的电影一部不落，人生目标就是下一个乔帮主或者比尔盖茨，幼小的我想着，以后我也要写出让全世界的人都使用的操作系统，冠以自己的名号，当然，还有上不了台面的——想当世界首富 当然，后来我知道了...</div></div></div></a><a class="pagination-related" href="/posts/3b449868.html" title="设计模式与 Warcraft 其三"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover24.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">设计模式与 Warcraft 其三</div></div><div class="info-2"><div class="info-item-1"> 须知: 这并不是一篇教程，而是一篇笔记，  如果你想学习设计模式，建议直接阅读比较好的设计模式教程，比如 设计模式|菜鸟教程。   这篇文章我们来讲讲行为型模式… 吗？ 并不是，这篇文章先来讲一讲 part 1 中提到的大作业 Warcraft 3。 Warcraft 3 如果你对这个不管兴趣请点击 这里 跳过这一节。 什么是 Warcraft 3 魔兽争霸 3（Warcraft III: Reign of Chaos）是由暴雪娱乐公司开发的一款即时战略游戏，于2002年7月3日发行。游戏的故事发生在魔兽争霸系列的虚构世界中，讲述了一场由人类、兽人、亡灵和暗夜精灵四个种族之间的战争。游戏的扩展包《冰封王座》于2003年7月1日发行。  我顺便下载下来玩了会儿，很好玩，推荐。  大作业的要求 然而，这个大作业除了名字，和魔兽争霸 3 没有任何关系。 除此之外，这个大作业甚至并不是原创，实际上，经查证，原题来自 北京大学...</div></div></div></a></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Jenway</div><div class="author-info-description">I love you more than you ever know</div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">54</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">49</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">11</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Jenway"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Jenway" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:JenwayHere@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="https://music.163.com/#/user/home?id=453746313" target="_blank" title="netease"><i class="iconfont icon-netease-cloud-music-fill" style="color: #d51007;"></i></a><a class="social-icon" href="https://space.bilibili.com/179871013" target="_blank" title="bilibili"><i class="fab fa-bilibili" style="color: #00a1d6;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content"><center> =( •̀ ω •́ )= </center></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-GCC"><span class="toc-number">1.1.</span> <span class="toc-text">什么是 GCC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Clang"><span class="toc-number">1.2.</span> <span class="toc-text">什么是 Clang</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Win-%E4%B8%8B%E4%BD%BF%E7%94%A8-GCC-%E7%9A%84%E4%B8%A4%E5%A4%A7%E6%80%9D%E8%B7%AF"><span class="toc-number">2.</span> <span class="toc-text">Win 下使用 GCC 的两大思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%A8-Win-%E4%B8%8B%E4%BD%BF%E7%94%A8-GCC-%E7%9A%84%E5%8E%86%E5%8F%B2"><span class="toc-number">3.</span> <span class="toc-text">在 Win 下使用 GCC 的历史</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Cygwin"><span class="toc-number">3.1.</span> <span class="toc-text">Cygwin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Cygwin"><span class="toc-number">3.1.1.</span> <span class="toc-text">什么是 Cygwin?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E4%B8%8D%E6%98%AF-Cygwin"><span class="toc-number">3.1.2.</span> <span class="toc-text">什么不是 Cygwin?</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MinGW"><span class="toc-number">3.2.</span> <span class="toc-text">MinGW</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MinGW-w64"><span class="toc-number">3.3.</span> <span class="toc-text">MinGW-w64</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E5%B0%8F%E6%95%85%E4%BA%8B"><span class="toc-number">3.3.1.</span> <span class="toc-text">一个小故事</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MinGW-w64-%E5%B9%B6%E4%B8%8D%E5%8C%85%E5%90%AB-gcc-%E7%BC%96%E8%AF%91%E5%99%A8"><span class="toc-number">3.3.2.</span> <span class="toc-text">MinGW-w64 并不包含 gcc 编译器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MinGW-w64%E7%9A%84%E4%BC%97%E5%A4%9ABuild"><span class="toc-number">3.3.3.</span> <span class="toc-text">MinGW-w64的众多Build</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSYS2"><span class="toc-number">3.4.</span> <span class="toc-text">MSYS2</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8E-Cygwin%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">3.4.1.</span> <span class="toc-text">与 Cygwin的关系</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8EMinGW-w64"><span class="toc-number">3.4.2.</span> <span class="toc-text">与MinGW-w64</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MinGW-%E5%92%8C-MinGW-w64-%E4%B8%8D%E6%98%AF%E5%90%8C%E4%B8%80%E4%B8%AA%E9%A1%B9%E7%9B%AE"><span class="toc-number">3.5.</span> <span class="toc-text">MinGW 和 MinGW-w64 不是同一个项目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%AD%E5%9C%BA%E6%80%BB%E7%BB%93-GCC"><span class="toc-number">4.</span> <span class="toc-text">中场总结 GCC</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Win-%E4%B8%8B-Clang-%E7%9A%84%E4%B8%A4%E7%A7%8D%E7%BC%96%E8%AF%91%E5%99%A8%E5%90%8E%E7%AB%AF"><span class="toc-number">5.</span> <span class="toc-text">Win 下 Clang 的两种编译器后端</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#posix%E3%80%81%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B%E3%80%81ABI-%E4%BB%A5%E5%8F%8A%E5%85%B6%E4%BB%96"><span class="toc-number">6.</span> <span class="toc-text">posix、线程模型、ABI 以及其他</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#x86-64-vs-i686"><span class="toc-number">6.1.</span> <span class="toc-text">x86_64 vs i686</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#posix-vs-win32-vs-MCF"><span class="toc-number">6.2.</span> <span class="toc-text">posix vs win32 vs MCF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sjlj-vs-dwarf-vs-seh"><span class="toc-number">6.3.</span> <span class="toc-text">sjlj vs dwarf vs seh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MSVCRT-%E4%B8%8E-UCRT"><span class="toc-number">6.4.</span> <span class="toc-text">MSVCRT 与 UCRT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><span class="toc-number">8.</span> <span class="toc-text">参考资料</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/9e99c60f.html" title="图片与视频编码"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover34.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="图片与视频编码"/></a><div class="content"><a class="title" href="/posts/9e99c60f.html" title="图片与视频编码">图片与视频编码</a><time datetime="2024-10-11T13:27:14.000Z" title="Created 2024-10-11 21:27:14">2024-10-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/46e1063e.html" title="Back to Regression with PyTorch"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover28.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Back to Regression with PyTorch"/></a><div class="content"><a class="title" href="/posts/46e1063e.html" title="Back to Regression with PyTorch">Back to Regression with PyTorch</a><time datetime="2024-09-25T05:46:37.000Z" title="Created 2024-09-25 13:46:37">2024-09-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/5774811a.html" title="我没有去过巴塞罗那，但是 42"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover15.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="我没有去过巴塞罗那，但是 42"/></a><div class="content"><a class="title" href="/posts/5774811a.html" title="我没有去过巴塞罗那，但是 42">我没有去过巴塞罗那，但是 42</a><time datetime="2024-07-15T05:42:11.000Z" title="Created 2024-07-15 13:42:11">2024-07-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/e585f8d9.html" title="使用 Git-filter-repo 来清理你的 Git Repo 历史"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover26.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="使用 Git-filter-repo 来清理你的 Git Repo 历史"/></a><div class="content"><a class="title" href="/posts/e585f8d9.html" title="使用 Git-filter-repo 来清理你的 Git Repo 历史">使用 Git-filter-repo 来清理你的 Git Repo 历史</a><time datetime="2024-06-29T07:10:47.000Z" title="Created 2024-06-29 15:10:47">2024-06-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/baaf2f47.html" title="回归与迭代优化"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://fastly.jsdelivr.net/gh/jenway/J-figure-bed@master/cover/cover18.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="回归与迭代优化"/></a><div class="content"><a class="title" href="/posts/baaf2f47.html" title="回归与迭代优化">回归与迭代优化</a><time datetime="2024-06-26T13:18:40.000Z" title="Created 2024-06-26 21:18:40">2024-06-26</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Jenway</div><div class="footer_custom_text"><div style="text-align:center">
  <br />
  <b>I love you more than you ever know.</b>
  <br />
  <br />
  <a target="_blank" href="https://hexo.io/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=for-the-badge&logo=hexo" title="博客框架为Hexo">
  <a target="_blank" href="https://butterfly.js.org/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=for-the-badge&logo=honey" title="博客主题为butterfly">
  <br />
  <a target="_blank" href="https://icp.gov.moe/?keyword=20227445" title="本站已加入萌ICP，萌ICP备20227445号">
  <img style="width:32px;height:32px;margin-bottom:-8px" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://icp.gov.moe/images/ico64.png">
  <img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20227445-fe1384?style=for-the-badge">
  <br />
  </a>&nbsp;<a target="_blank" href="https://github.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=for-the-badge&logo=GitHub" title="Gtihub托管">
  </a>&nbsp;<a target="_blank" href="https://cloudflare.net/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-Cloudflare-orange?style=for-the-badge&logo=Cloudflare" title="CloudFlare提供CDN加速">
  </a>&nbsp;<a target="_blank" href="https://app.netlify.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Hosted-Netlify-darkcyan?style=for-the-badge&logo=Netlify" title="Netlify托管">
  </a>&nbsp;<a target="_blank" href="https://www.name.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Domain-Name.com-0cedbe?style=for-the-badge&logo=google" title="域名白嫖自 name.com ">
  </a>&nbsp;
  <br />
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>
  <br />本站已萌萌哒运行 <span id='htmer_time'></span>
</div>
</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo-api-jenway.netlify.app/.netlify/functions/twikoo',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo-api-jenway.netlify.app/.netlify/functions/twikoo',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    GLOBAL_CONFIG_SITE.isPost && getCount()

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="I,LOVE,YOU,MORE,THAN,YOU,EVER,KNOW" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script src="/js/dynamicTabTitle.js"></script><script src="/js/runtimeShow.js"></script>
  <!-- require APlayer -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
  <script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
  <!-- require MetingJS -->
  <script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
  <script src="https://fastly.jsdelivr.net/gh/stevenjoezhang/live2d-widget@latest/autoload.js"></script>
  <meting-js
    server="netease"
    type="playlist"
    order="random"
    id="7290416033"
    fixed=true
    list-folded = "true"
    >
    </meting-js>
  <!-- hexo injector body_end end --></body></html>